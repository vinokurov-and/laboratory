# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å API —á–µ—Ä–µ–∑ React. –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é jest + mockFetch

## –ß–∞—Å—Ç—å 1: –°–æ–∑–¥–∞–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç UserTable.tsx

### 1. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª:
src/components/UserTable.tsx

### 2. –ù–∞–ø–∏—à–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π:
- –ò–º–µ–µ—Ç –∫–Ω–æ–ø–∫—É ¬´–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π¬ª
- –ü—Ä–∏ –∫–ª–∏–∫–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å https://jsonplaceholder.typicode.com/users
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏: –ò–º—è, Email, –¢–µ–ª–µ—Ñ–æ–Ω, –°–∞–π—Ç
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É (Loading...) –∏ –æ—à–∏–±–∫—É (–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ)

```javascript
import { useState } from 'react'

export default function UserTable() {
  const [users, setUsers] = useState([])
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState<string | null>(null)

  const fetchUsers = async () => {
    setLoading(true)
    setError(null)
    try {
      const response = await fetch('https://jsonplaceholder.typicode.com/users')
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`)
      }
      const data = await response.json()
      setUsers(data)
    } catch (err) {
      setError(err instanceof Error ? err.message : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞')
    } finally {
      setLoading(false)
    }
  }

  return (
    <div className="user-table-container">
      <button onClick={fetchUsers} disabled={loading}>
        {loading ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : '–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π'}
      </button>

      {error && <p style={{ color: 'red' }}>{error}</p>}

      {users.length > 0 && (
        <table border={1} style={{ marginTop: '20px', borderCollapse: 'collapse', width: '100%' }}>
          <thead>
            <tr>
              <th>–ò–º—è</th>
              <th>Email</th>
              <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
              <th>–°–∞–π—Ç</th>
            </tr>
          </thead>
          <tbody>
            {users.map((user) => (
              <tr key={user.id}>
                <td>{user.name}</td>
                <td>{user.email}</td>
                <td>{user.phone}</td>
                <td>
                  <a href={`http://${user.website}`} target="_blank" rel="noopener noreferrer">
                    {user.website}
                  </a>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      )}
    </div>
  )
}
```

## –ß–∞—Å—Ç—å 2: –ü–æ–¥–∫–ª—é—á–∏ UserTable –≤ App.tsx
–î–æ–±–∞–≤—å UserTable –≤ App.tsx

```typescript
import UserTable from './components/UserTable'
import './App.css'

function App() {
  return (
    <>
      <div>
        <a href="https://vite.dev" target="_blank">
          <img src="/vite.svg" className="logo" alt="Vite logo" />
        </a>
        <a href="https://react.dev" target="_blank">
          <img src="/react.svg" className="logo react" alt="React logo" />
        </a>
      </div>
      <h1>Vite + React</h1>
      <Counter />
      <UserTable />
      <p className="read-the-docs">
        Click on the Vite and React logos to learn more
      </p>
    </>
  )
}

export default App
```

## –ß–∞—Å—Ç—å 3: –ù–∞–ø–∏—à–∏ —Ç–µ—Å—Ç—ã —Å –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ–º fetch

1. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª:
```
src/components/UserTable.test.tsx
```

2. –ù–∞–ø–∏—à–∏ —Ç—Ä–∏ —Ç–µ—Å—Ç–∞:

```javascript
import { render, screen, fireEvent } from '@testing-library/react'
import UserTable from './UserTable'

// üëá –ú–æ–∫–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π fetch
global.fetch = jest.fn()

describe('UserTable', () => {
  beforeEach(() => {
    jest.clearAllMocks() 
  })

  test('renders button and does not show table initially', () => {
    render(<UserTable />)
    expect(screen.getByText(/–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/i)).toBeInTheDocument()
    expect(screen.queryByText(/–∏–≤–∞–Ω/i)).not.toBeInTheDocument()
  })

  test('loads users and displays them when button is clicked', async () => {
    // üëá –ú–æ–∫–∞–µ–º —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç
    const mockUsers = [
      {
        id: 1,
        name: '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤',
        email: 'ivan@example.com',
        phone: '+7 (999) 123-45-67',
        website: 'example.com',
      },
    ]

    ;(fetch as jest.Mock).mockResolvedValue({
      ok: true,
      json: async () => mockUsers,
    })

    render(<UserTable />)
    fireEvent.click(screen.getByText(/–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/i))

    // –ñ–¥—ë–º, –ø–æ–∫–∞ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è
    expect(await screen.findByText(/–∏–≤–∞–Ω –∏–≤–∞–Ω–æ–≤/i)).toBeInTheDocument()
    expect(screen.getByText(/ivan@example.com/i)).toBeInTheDocument()
  })

  test('shows error when fetch fails', async () => {
    // üëá –ú–æ–∫–∞–µ–º –æ—à–∏–±–∫—É
    (fetch as jest.Mock).mockRejectedValue(new Error('Network error'))

    render(<UserTable />)
    fireEvent.click(screen.getByText(/–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/i))

    expect(await screen.findByText(/–æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ/i)).toBeInTheDocument()
  })
})
```
‚úÖ –í–∞–∂–Ω–æ:
- global.fetch = jest.fn() ‚Äî –º–æ–∫–∞–µ–º fetch –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤—Å–µ–≥–æ —Ç–µ—Å—Ç–∞
- –ù–∏–∫–∞–∫–∏—Ö —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Äî —Ç–µ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞


## –ß–∞—Å—Ç—å 4: –ü—Ä–æ–≤–µ—Ä–∫–∞

1. –ó–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç—ã –ª–æ–∫–∞–ª—å–Ω–æ –∏ –ø—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ç–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å —É—Å–ø–µ—à–Ω–æ.
2. –ü—Ä–æ–≤–µ—Ä—å –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –Ω–∞ Github
